<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Terminal_a_private</title>
  <link rel="stylesheet" href="terminal_logic.css">
  <script src="typeit.min.js"></script>
</head>
<body>
  <div id="terminal"></div>

  <script>
    const terminal = document.getElementById("terminal");

    // 生成乱码段
    const generateNoise = () =>
      Array.from({ length: 26 }, () =>
        Math.random() < 0.92
          ? String.fromCharCode(33 + Math.floor(Math.random() * 94))
          : " "
      ).join("");

    // 加载图片区域
    const insertImageSection = () => {
      const imgDiv = document.createElement("div");
      imgDiv.className = "img-preview";
      imgDiv.innerHTML = `
        <img src="terminal_image/photo1.jpg" alt="风景1">
        <img src="terminal_image/photo2.jpg" alt="风景2">
        <img src="terminal_image/photo3.jpg" alt="风景3">
      `;
      terminal.appendChild(imgDiv);
      terminal.scrollTop = terminal.scrollHeight;
    };

    // 聊天内容
    const messages = [
      { sender: "梦君", text: "这份实验数据我觉得没问题了，我在邮箱上发你了。" },
      { sender: "小芝士", text: "收到啦ovo师姐你太强了，这个实验我一直完成不了" },
      { sender: "梦君", text: "其实注意变量控制就可以了，别的地方你都完成得很好。" },
      { sender: "梦君", text: "小芝，你和你男朋友在一起多久了？" },
      { sender: "小芝士", text: "已经分手啦TvT" },
      { sender: "梦君", text: "啊？为什么呀？" },
      { sender: "小芝士", text: "因为异地恋嘛，要克服的困难比想象中要多很多。" },
      { sender: "梦君", text: "你们以前是因为什么在一起的呢？" },
      { sender: "小芝士", text: "从前是大学同学，经常一起做小组作业，自然而然就熟啦。" },
      { sender: "梦君", text: "这样的啊……" },
      { sender: "小芝士", text: "师姐你怎么突然还关心起恋爱来了？老实交代你是不是有情况！" },
      { sender: "梦君", text: "这种事情的时候怎么会这么敏锐？" },
      { sender: "小A", text: "好恶心，最讨厌看别人谈恋爱了。" },
      { sender: "小芝士", text: "？？？？真的啊！！" },
      { sender: "小芝士", text: "是谁！" },
      { sender: "小芝士", text: "可我最近没有看见师姐你和谁走得近呀ovo" },
      { sender: "梦君", text: "嗯……" },
      { sender: "梦君", text: "没在一起" },
      { sender: "小芝士", text: "异地恋？!" },
      { sender: "梦君", text: "差不多吧。" },
      { sender: "小芝士", text: "天啊……师姐你不要把我前面的话放心上。其实只要两个人有心，就没什么不能克服的。" },
      { sender: "小芝士", text: "师姐你最近几天怎么都没来实验室" },
      { sender: "小芝士", text: "师姐你生病了吗？" },
      { sender: "小芝士", text: "师姐那个……是怎么回事？" },
      { sender: "小芝士", text: "师姐你别太伤心了……虽然不了解具体发生了什么，但是我永远支持你！" },
    ];

    let index = 0;

    function printNextMessage() {
      if (index >= messages.length) {
        setTimeout(openRepairWindow, 1000);
        return;
      }

      const line = document.createElement("div");
      line.className = "chat-line";
      const noiseBefore = generateNoise();
      const noiseAfter = generateNoise();
      line.innerHTML = `${noiseBefore} ${messages[index].sender}：${messages[index].text} ${noiseAfter}`;
      terminal.appendChild(line);
      terminal.scrollTop = terminal.scrollHeight;

      index++;
      setTimeout(printNextMessage, 600);
    }

    function openRepairWindow() {
      window.open('repair.html', '_blank', 'width=640,height=400');
    }

    // 打印初始化提示 + 插入图 + 开始聊天
    new TypeIt("#terminal", {
      speed: 20,
      cursorChar: "_",
      startDelay: 500
    })
      .type(">>> 已进入用户21的系统")
      .break().pause(400)
      .type(">>> 尝试恢复照片中...")
      .pause(1000)
      .exec(insertImageSection)
      .break()
      .type(">>> 尝试恢复微信数据：...")
      .pause(800)
      .exec(() => printNextMessage())
      .go();
  </script>
</body>
</html>
