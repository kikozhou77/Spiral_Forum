<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„ä¿¡æ¯ - èºæ—‹è®ºå›</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .chat-divider {
            border: none;
            border-top: 1px solid #ccc;
            margin: 20px 0;
        }
        .delete-button {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            margin-left: 10px;
        }
        .delete-button:hover {
            background-color: #bd2130;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">èºæ—‹è®ºå›</div>
            <div>ç”¨æˆ·å°A | 
                <a href="messages.html">ç§ä¿¡
                    <span id="msg-badge" class="notification-badge">99+</span>
                </a>
            </div>
        </header>

        <nav>
            <a href="index.html">é¦–é¡µ</a>
            <a href="my_follows.html">æˆ‘çš„å…³æ³¨</a>
            <a href="my_profile.html">æˆ‘çš„ä¸»é¡µ</a>
            <a href="messages.html" class="active">æˆ‘çš„ä¿¡æ¯</a>
            <a href="post_detail.html" class="post-button">æˆ‘è¦å‘å¸–ï¼</a>
        </nav>

        <main>
            <div class="chat-layout">
                <div class="contact-list" id="contact-list-container">
                    <h2>ç§ä¿¡åˆ—è¡¨ 
                        <button onclick="alert('å·²å…¨éƒ¨è®¾ä¸ºå·²è¯»ï¼')">ä¸€é”®å·²è¯»</button>
                    </h2>
                    <div class="contact-item" data-contact-id="troll" onclick="loadChat('troll')">
                        <img src="https://via.placeholder.com/48/000/FFF?text=å‰‘" class="contact-avatar">
                        <div class="contact-info">
                            <div class="name">sohnwhnalqq9912_xlk</div>
                            <div class="preview">...</div>
                        </div>
                    </div>
                    <div class="contact-item" data-contact-id="user21" onclick="loadChat('user21')">
                        <img src="https://via.placeholder.com/48/ccc/000?text=?" class="contact-avatar">
                        <div class="contact-info">
                            <div class="name">ç”¨æˆ·21</div>
                            <div class="preview">...</div>
                        </div>
                    </div>
                </div>

                <div id="chat-content-area" class="chat-window" style="align-items: center; justify-content: center;">
                    <h2 style="color: #999;">ç‚¹å‡»å·¦ä¾§è”ç³»äººå¼€å§‹å¯¹è¯</h2>
                </div>
            </div>
        </main>
    </div>

    <script>
        const chatData = {
            troll: {
                name: 'sohnwhnalqq9912_xlk',
                profileLink: '#',
                replies: [
                    'åƒä½ è¿™ç§é˜´æš—è€é¼ å°±åªæ•¢èº²åœ¨ç”µè„‘åé¢ï¼Œä¸€å®šä¸‘å¾—æƒŠäººï¼Œåœ¨ç°å®é‡Œæ´»å¾—å¾ˆå¯æ€œå§ã€‚',
                    'åˆšæ³¨å†Œçš„æ–°å·ï¼Œä½ å¼€ã€‚',
                    'æˆ‘ä¼šè®©ä½ åæ‚”çš„ã€‚',
                    'ä¸ä¿¡ä½ å¯ä»¥è¯•è¯•ã€‚'
                ]
            },
            user21: {
                name: 'ç”¨æˆ·21',
                profileLink: 'user21_profile.html',
                replies: [
                    'å¾ˆæŠ±æ­‰ï¼Œå†’æ˜§æ‰“æ‰°â€¦â€¦æˆ‘å¤±å¿†äº†ï¼Œç›®å‰åªæœ‰ä¸€å°ç”µè„‘ï¼Œæˆ‘æƒ³ä»ç”µè„‘é‡Œæ‰¾åˆ°ä¸€äº›çº¿ç´¢ã€‚',
                    'æˆ‘æ— æ³•å»åŒ»é™¢ã€‚',
                    'æŠ±æ­‰ï¼Œæ¯•ç«Ÿè¿™æ˜¯ä¸€å°è¢«æ ¼å¼åŒ–çš„ç”µè„‘ï¼Œæˆ‘æƒ³è¿™ä¸ªè¯·æ±‚ç¡®å®å¤ªå¼ºäººæ‰€éš¾äº†ã€‚',
                    'è°¢è°¢â€¦â€¦é‚£å°±æ‹œæ‰˜æ‚¨äº†ï¼',
                    'æˆ‘å¯ä»¥æŠŠæˆ‘çš„ç”µè„‘æƒé™å®Œå…¨å¯¹æ‚¨æ•å¼€ã€‚',
                    'ä¸æ˜¯ã€‚',
                    'è¯·ç¨ç­‰ï¼Œæ‚¨æ˜¯å‘ç°ä»€ä¹ˆäº†å—ï¼Ÿ',
                    'å¥¹æ˜¯æˆ‘çš„çˆ±äººã€‚',
                    'ä»æˆ‘é†’æ¥å¼€å§‹ï¼Œæˆ‘å°±åœ¨å¯»æ‰¾å¥¹ï¼Œå¯æˆ‘ä¸€æ— æ‰€è·ï¼Œæˆ‘çš„è®°å¿†å¤±å»å¾—å¤ªå½»åº•ã€‚',
                    'æˆ‘åªæƒ³æ‰¾å›å’Œå¥¹çš„è®°å¿†ã€‚',
                    'æˆ‘çŸ¥é“â€¦â€¦æ‚¨ä¿®å¤çš„ä¸œè¥¿ï¼Œæˆ‘åœ¨è¿™è¾¹éƒ½èƒ½çœ‹è§ã€‚',
                    'æˆ‘æœ‰ç‚¹ç´§å¼ ã€‚',
                    'æˆ‘ä¸æƒ³æ‰“æ‰°å¥¹çš„ç”Ÿæ´»ï¼Œèƒ½çŸ¥é“å¥¹ç°åœ¨è¿‡å¾—å¾ˆå¥½ï¼Œå¯¹æˆ‘æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚',
                    'æˆ‘æ˜¯è¿™å°ç”µè„‘ã€‚',
                    'è°¢è°¢æ‚¨çš„ç›¸ä¿¡ã€‚',
                    'æ˜å¤©æˆ‘å°±è¦è¿›åƒåœ¾å¤„ç†å™¨äº†ã€‚',
                    'å—¯ï¼Œæˆ‘è¯¥æ€ä¹ˆè¯´â€¦åœ¨æˆ‘ç”Ÿå‘½çš„å°½å¤´ï¼Œèƒ½æœ€åçŸ¥é“å¥¹æ˜¯æ€æ ·çš„äººï¼Œæˆ‘å·²ç»æ— é™æ„Ÿæ©äº†ã€‚',
                    'æ‚¨å¸®æˆ‘å®ç°äº†è¿™ä¸ªæ„¿æœ›ï¼Œæˆ‘å·²ç»æ²¡æœ‰ä»»ä½•é—æ†¾äº†ã€‚',
                    'å…¶å®æ¯”èµ·æˆ‘ï¼Œæˆ‘æƒ³ä¹Ÿè®¸æ‚¨æ›´åº”è¯¥å…³å¿ƒä¸€ä¸‹æ‚¨çš„ç”µè„‘ã€‚',
                    'ä¸ã€‚ä»–å¥½åƒæ¨æ‚¨ã€‚'
                ]
            }
        };
        
    const chatHistory = {};
    let activeContactId = null;

    function loadChat(contactId) {
        activeContactId = contactId;
        const data = chatData[contactId];
        if (!data) return;

        const contentArea = document.getElementById('chat-content-area');
        contentArea.innerHTML = '';

        const header = document.createElement('div');
        header.classList.add('chat-header');
        header.innerHTML = `<a href="${data.profileLink}">${data.name}</a>
            <button class="delete-button" onclick="clearChat('${contactId}')">æ¸…ç©ºè®°å½•</button>`;

        const divider = document.createElement('hr');
        divider.className = 'chat-divider';

        const messageBox = document.createElement('div');
        messageBox.classList.add('chat-messages');
        messageBox.id = 'message-container';

        contentArea.appendChild(header);
        contentArea.appendChild(divider);
        contentArea.appendChild(messageBox);

        (chatHistory[contactId] || []).forEach(msg => {
            const bubble = document.createElement('div');
            bubble.className = `message-bubble msg-${msg.type}`;
            bubble.textContent = msg.text;
            messageBox.appendChild(bubble);
        });

        // ğŸŸ¢ è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
        messageBox.scrollTop = messageBox.scrollHeight;

        const inputArea = document.createElement('div');
        inputArea.className = 'chat-input-area';
        inputArea.innerHTML = `
            <input type="text" id="real-input" class="chat-input" placeholder="è¾“å…¥æ¶ˆæ¯åæŒ‰ Enter...">
            <button id="send-btn" class="send-button">â†‘</button>
        `;
        contentArea.appendChild(inputArea);

        document.getElementById('send-btn').addEventListener('click', handleUserMessage);
        document.getElementById('real-input').addEventListener('keydown', (e) => {
            if (e.key === 'Enter') handleUserMessage();
        });

        if (!(contactId in chatHistory)) {
            chatHistory[contactId] = [];
            simulateBotReply(contactId);
        }
    }

    function handleUserMessage() {
        const input = document.getElementById('real-input');
        const text = input.value.trim();
        if (!text) return;
        input.value = '';

        const bubble = document.createElement('div');
        bubble.className = 'message-bubble msg-sent';
        bubble.textContent = text;
        document.getElementById('message-container').appendChild(bubble);

        chatHistory[activeContactId].push({ text, type: 'sent' });
        updatePreview(activeContactId, text);

        // ğŸŸ¢ è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
        const messageBox = document.getElementById('message-container');
        messageBox.scrollTop = messageBox.scrollHeight;

        simulateBotReply(activeContactId);
    }

    function simulateBotReply(contactId) {
        const replies = chatData[contactId]?.replies || [];
        const history = chatHistory[contactId];
        const replyIndex = history.filter(m => m.type === 'received').length;

        if (replyIndex >= replies.length) return;

        setTimeout(() => {
            const text = replies[replyIndex];
            const bubble = document.createElement('div');
            bubble.className = 'message-bubble msg-received';
            bubble.textContent = text;
            document.getElementById('message-container').appendChild(bubble);
            chatHistory[contactId].push({ text, type: 'received' });
            updatePreview(contactId, text);

            // ğŸŸ¢ è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            const messageBox = document.getElementById('message-container');
            messageBox.scrollTop = messageBox.scrollHeight;
        }, 1000 + Math.random() * 1000);
    }

    function updatePreview(contactId, text) {
        const contactItem = document.querySelector(`.contact-item[data-contact-id="${contactId}"]`);
        if (contactItem) {
            const previewEl = contactItem.querySelector('.preview');
            previewEl.textContent = text.substring(0, 20) + '...';
        }
    }

    function clearChat(contactId) {
        if (confirm("ç¡®å®šè¦æ¸…ç©ºå½“å‰èŠå¤©è®°å½•å—ï¼Ÿ")) {
            chatHistory[contactId] = [];
            loadChat(contactId);
        }
    }

    // åˆå§‹åŒ–æ‰€æœ‰è”ç³»äººé¢„è§ˆ
    document.querySelectorAll('.contact-item').forEach(item => {
        const cid = item.dataset.contactId;
        const data = chatData[cid];
        if (data && data.replies.length) {
            const previewEl = item.querySelector('.preview');
            previewEl.textContent = data.replies[0].substring(0, 20) + '...';
        }
    });
</script>
